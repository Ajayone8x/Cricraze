<!DOCTYPE html>  
<html>  
<head>  
  <meta charset="UTF-8">  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">  
  <title>Sony LIV - Premium Streaming</title>     
  <script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.7.11/shaka-player.ui.min.js" crossorigin="anonymous"></script>  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.7.11/controls.min.css" crossorigin="anonymous">  
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>  
   * { margin: 0; padding: 0; box-sizing: border-box; }  
    html, body {  
      background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);  
      height: 100vh;  
      width: 100vw;  
      overflow: hidden;  
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;  
    }  
    
    .shaka-video-container {  
      position: absolute;  
      inset: 0;  
      width: 100%;  
      height: 100%;  
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
    }  
    
    video {  
      width: 100%;  
      height: 100%;  
      background: #000;  
      object-fit: contain;  
      border-radius: 12px;
    }  
    
    .shaka-spinner-container,  
    .shaka-spinner,  
    .shaka-spinner-svg {  
      display: none !important;  
      visibility: hidden !important;  
      opacity: 0 !important;  
    }
    
    /* Telegram Popup Styles - Modern Neon Design */
    .telegram-popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0.8);
      background: linear-gradient(145deg, #0a0a0a 0%, #1a1a1a 50%, #0f0f0f 100%);
      color: white;
      padding: 30px;
      border-radius: 20px;
      z-index: 10000;
      opacity: 0;
      transition: all 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      max-width: 400px;
      width: 90%;
      backdrop-filter: blur(20px);
      border: 2px solid transparent;
      background-clip: padding-box;
      box-shadow: 
        0 0 50px rgba(0, 136, 204, 0.3),
        0 0 100px rgba(138, 43, 226, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      position: relative;
      overflow: hidden;
    }
    
    .telegram-popup::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(45deg, 
        rgba(0, 136, 204, 0.8) 0%, 
        rgba(138, 43, 226, 0.8) 25%,
        rgba(255, 20, 147, 0.8) 50%,
        rgba(138, 43, 226, 0.8) 75%,
        rgba(0, 136, 204, 0.8) 100%);
      border-radius: 20px;
      padding: 2px;
      mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      mask-composite: exclude;
      -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      -webkit-mask-composite: xor;
      animation: borderGlow 3s ease-in-out infinite;
    }
    
    @keyframes borderGlow {
      0%, 100% { 
        background: linear-gradient(45deg, 
          rgba(0, 136, 204, 0.8) 0%, 
          rgba(138, 43, 226, 0.8) 25%,
          rgba(255, 20, 147, 0.8) 50%,
          rgba(138, 43, 226, 0.8) 75%,
          rgba(0, 136, 204, 0.8) 100%);
      }
      50% { 
        background: linear-gradient(45deg, 
          rgba(255, 20, 147, 0.8) 0%, 
          rgba(0, 136, 204, 0.8) 25%,
          rgba(138, 43, 226, 0.8) 50%,
          rgba(0, 136, 204, 0.8) 75%,
          rgba(255, 20, 147, 0.8) 100%);
      }
    }
    
    .telegram-popup::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: conic-gradient(
        from 0deg,
        transparent 0deg,
        rgba(0, 136, 204, 0.1) 60deg,
        rgba(138, 43, 226, 0.1) 120deg,
        rgba(255, 20, 147, 0.1) 180deg,
        rgba(138, 43, 226, 0.1) 240deg,
        rgba(0, 136, 204, 0.1) 300deg,
        transparent 360deg
      );
      animation: rotate 4s linear infinite;
      opacity: 0.3;
      z-index: -1;
    }
    
    @keyframes rotate {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .telegram-popup.show {
      transform: translate(-50%, -50%) scale(1);
      opacity: 1;
    }
    
    .telegram-header {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 20px;
      gap: 15px;
    }
    
    .telegram-icon {
      width: 50px;
      height: 50px;
      background: linear-gradient(135deg, #0088cc 0%, #8a2be2 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      animation: iconPulse 2s ease-in-out infinite;
      box-shadow: 
        0 0 20px rgba(0, 136, 204, 0.5),
        0 0 40px rgba(138, 43, 226, 0.3);
      position: relative;
      overflow: hidden;
    }
    
    .telegram-icon::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      animation: shimmer 2s infinite;
    }
    
    @keyframes shimmer {
      0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
      100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
    }
    
    @keyframes iconPulse {
      0%, 100% { 
        transform: scale(1);
        box-shadow: 
          0 0 20px rgba(0, 136, 204, 0.5),
          0 0 40px rgba(138, 43, 226, 0.3);
      }
      50% { 
        transform: scale(1.1);
        box-shadow: 
          0 0 30px rgba(0, 136, 204, 0.8),
          0 0 60px rgba(138, 43, 226, 0.5);
      }
    }
    
    .telegram-title {
      font-weight: 700;
      font-size: 24px;
      margin: 0;
      background: linear-gradient(45deg, #00a8ff, #8a2be2, #ff1493);
      background-size: 200% 200%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: titleGradient 3s ease-in-out infinite;
      text-align: center;
    }
    
    @keyframes titleGradient {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }
    
    .telegram-message {
      font-size: 16px;
      line-height: 1.5;
      margin-bottom: 25px;
      opacity: 0.9;
      text-align: center;
      color: #e0e0e0;
    }
    
    .telegram-buttons {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .telegram-btn {
      padding: 15px 25px;
      border: none;
      border-radius: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      font-size: 16px;
      position: relative;
      overflow: hidden;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .telegram-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s;
    }
    
    .telegram-btn:hover::before {
      left: 100%;
    }
    
    .telegram-btn.primary {
      background: linear-gradient(135deg, #0088cc 0%, #8a2be2 50%, #ff1493 100%);
      color: white;
      box-shadow: 
        0 8px 25px rgba(0, 136, 204, 0.4),
        0 0 20px rgba(138, 43, 226, 0.3);
    }
    
    .telegram-btn.primary:hover {
      transform: translateY(-3px) scale(1.02);
      box-shadow: 
        0 15px 35px rgba(0, 136, 204, 0.6),
        0 0 30px rgba(138, 43, 226, 0.5),
        0 0 50px rgba(255, 20, 147, 0.3);
    }
    
    .telegram-btn.primary:active {
      transform: translateY(-1px) scale(0.98);
    }
    
    .telegram-btn.secondary {
      background: rgba(255, 255, 255, 0.05);
      color: #e0e0e0;
      border: 2px solid rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(10px);
    }
    
    .telegram-btn.secondary:hover {
      transform: translateY(-2px);
      background: rgba(255, 255, 255, 0.1);
      border-color: rgba(255, 255, 255, 0.4);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
    }
    
    .telegram-close {
      position: absolute;
      top: 15px;
      right: 15px;
      background: rgba(255, 255, 255, 0.1);
      border: none;
      color: #e0e0e0;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
    }
    
    .telegram-close:hover {
      background: rgba(255, 20, 147, 0.3);
      color: white;
      transform: rotate(90deg) scale(1.1);
      box-shadow: 0 0 15px rgba(255, 20, 147, 0.5);
    }
    
    /* Enhanced Player Controls */
    .shaka-video-container .shaka-controls-container {
      background: linear-gradient(to top, rgba(0, 0, 0, 0.8) 0%, transparent 100%);
      border-radius: 0 0 12px 12px;
    }
    
    .shaka-video-container .shaka-controls-button {
      transition: all 0.3s ease;
    }
    
    .shaka-video-container .shaka-controls-button:hover {
      transform: scale(1.1);
      filter: brightness(1.2);
    }
    
    .shaka-video-container .shaka-seek-bar-container {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
      margin: 0 10px;
    }
    
    .shaka-video-container .shaka-seek-bar {
      background: linear-gradient(90deg, #ff6b6b 0%, #4ecdc4 100%);
      border-radius: 4px;
      height: 4px;
    }
    
    .shaka-video-container .shaka-volume-bar {
      background: linear-gradient(90deg, #ff6b6b 0%, #4ecdc4 100%);
      border-radius: 4px;
    }
    
    /* Loading Animation */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      transition: opacity 0.5s ease;
    }
    
    .loading-overlay.hidden {
      opacity: 0;
      pointer-events: none;
    }
    
    .loading-spinner {
      width: 60px;
      height: 60px;
      border: 3px solid rgba(255, 255, 255, 0.1);
      border-top: 3px solid #0088cc;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .loading-text {
      color: white;
      margin-top: 20px;
      font-size: 16px;
      font-weight: 500;
      animation: fadeInOut 2s ease-in-out infinite;
    }
    
    @keyframes fadeInOut {
      0%, 100% { opacity: 0.5; }
      50% { opacity: 1; }
    }
    
    /* Enhanced Mobile Responsive Design */
    @media (max-width: 1024px) {
      .telegram-popup {
        max-width: 90%;
        padding: 25px;
      }
      
      .telegram-title {
        font-size: 22px;
      }
      
      .telegram-message {
        font-size: 15px;
      }
    }
    
    @media (max-width: 768px) {
      .telegram-popup {
        max-width: 95%;
        padding: 25px 20px;
        margin: 10px;
        border-radius: 16px;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(0.9);
      }
      
      .telegram-popup.show {
        transform: translate(-50%, -50%) scale(1);
      }
      
      .telegram-title {
        font-size: 20px;
        margin-bottom: 10px;
      }
      
      .telegram-message {
        font-size: 14px;
        margin-bottom: 20px;
        line-height: 1.4;
      }
      
      .telegram-btn {
        padding: 14px 20px;
        font-size: 14px;
        min-height: 48px; /* Better touch target */
        border-radius: 10px;
      }
      
      .telegram-icon {
        width: 45px;
        height: 45px;
        font-size: 20px;
      }
      
      .telegram-close {
        width: 35px;
        height: 35px;
        font-size: 16px;
        top: 12px;
        right: 12px;
      }
      
      /* Reduce animation intensity on mobile for better performance */
      .telegram-popup::after {
        animation-duration: 6s;
      }
      
      .telegram-icon {
        animation-duration: 3s;
      }
    }
    
    @media (max-width: 480px) {
      .telegram-popup {
        max-width: 98%;
        padding: 20px 15px;
        margin: 5px;
        border-radius: 14px;
      }
      
      .telegram-title {
        font-size: 18px;
        margin-bottom: 8px;
      }
      
      .telegram-message {
        font-size: 13px;
        margin-bottom: 18px;
        line-height: 1.3;
      }
      
      .telegram-btn {
        padding: 12px 18px;
        font-size: 13px;
        min-height: 44px;
        border-radius: 8px;
        letter-spacing: 0.5px;
      }
      
      .telegram-icon {
        width: 40px;
        height: 40px;
        font-size: 18px;
      }
      
      .telegram-close {
        width: 32px;
        height: 32px;
        font-size: 14px;
        top: 10px;
        right: 10px;
      }
      
      .telegram-header {
        margin-bottom: 15px;
        gap: 12px;
      }
    }
    
    @media (max-width: 360px) {
      .telegram-popup {
        padding: 18px 12px;
        margin: 3px;
      }
      
      .telegram-title {
        font-size: 16px;
      }
      
      .telegram-message {
        font-size: 12px;
      }
      
      .telegram-btn {
        padding: 10px 16px;
        font-size: 12px;
        min-height: 42px;
      }
      
      .telegram-icon {
        width: 35px;
        height: 35px;
        font-size: 16px;
      }
    }
    
    /* Touch device optimizations */
    @media (hover: none) and (pointer: coarse) {
      .telegram-btn {
        transition: all 0.2s ease;
      }
      
      .telegram-btn:active {
        transform: scale(0.95);
      }
      
      .telegram-btn.primary:active {
        transform: scale(0.95);
      }
      
      .telegram-btn.secondary:active {
        transform: scale(0.95);
      }
      
      .telegram-close:active {
        transform: rotate(90deg) scale(0.9);
      }
      
      /* Reduce hover effects on touch devices */
      .telegram-btn:hover {
        transform: none;
      }
      
      .telegram-btn.primary:hover {
        transform: none;
      }
      
      .telegram-btn.secondary:hover {
        transform: none;
      }
      
      .telegram-close:hover {
        transform: none;
      }
    }
    
    /* Landscape mobile optimization */
    @media (max-height: 500px) and (orientation: landscape) {
      .telegram-popup {
        max-height: 90vh;
        overflow-y: auto;
        padding: 15px 20px;
      }
      
      .telegram-title {
        font-size: 18px;
        margin-bottom: 8px;
      }
      
      .telegram-message {
        font-size: 13px;
        margin-bottom: 15px;
      }
      
      .telegram-buttons {
        gap: 10px;
      }
      
      .telegram-btn {
        padding: 10px 20px;
        font-size: 13px;
        min-height: 40px;
      }
      
      .telegram-icon {
        width: 35px;
        height: 35px;
        font-size: 16px;
      }
      
      .telegram-header {
        margin-bottom: 12px;
      }
    }
    
    /* High DPI displays */
    @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
      .telegram-popup {
        border-width: 1px;
      }
      
      .telegram-btn {
        border-width: 1px;
      }
    }
  </style>  
</head>  
<body>  
  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loadingOverlay">
    <div>
      <div class="loading-spinner"></div>
      <div class="loading-text">Loading Premium Content...</div>
    </div>
  </div>

  <!-- Telegram Popup -->
  <div class="telegram-popup" id="telegramPopup">
    <button class="telegram-close" onclick="closeTelegramPopup()">
      <i class="fas fa-times"></i>
    </button>
    <div class="telegram-header">
      <div class="telegram-icon">
        <i class="fab fa-telegram-plane"></i>
      </div>
    </div>
    <h3 class="telegram-title">Support Us!</h3>
    <div class="telegram-message">
      Join our Telegram for latest updates.
    </div>
    <div class="telegram-buttons">
      <button class="telegram-btn primary" onclick="joinTelegram()">
        Join Now
      </button>
      <button class="telegram-btn secondary" onclick="closeTelegramPopup()">
        Already Joined
      </button>
    </div>
  </div>

  <div class="shaka-video-container" data-shaka-player>  
    <video autoplay playsinline preload="metadata" poster="https://i.ibb.co/PGkCs5vz/ab188872-6178-43c2-a831-22a3de37390b.png"></video>  
  </div>  
  
  <script>  
    // Telegram Popup Functions
    function showTelegramPopup() {
      const popup = document.getElementById('telegramPopup');
      // Add entrance animation with delay
      setTimeout(() => {
        popup.classList.add('show');
        // Add some extra visual effects
        createFloatingParticles();
        // Add mobile-specific enhancements
        addMobileEnhancements();
      }, 1500); // Show after 1.5 seconds
    }

    // Mobile-specific enhancements
    function addMobileEnhancements() {
      const popup = document.getElementById('telegramPopup');
      const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
      
      if (isMobile) {
        // Prevent body scroll when popup is open
        document.body.style.overflow = 'hidden';
        
        // Add touch event listeners for better mobile interaction
        const buttons = popup.querySelectorAll('.telegram-btn');
        buttons.forEach(button => {
          button.addEventListener('touchstart', function(e) {
            this.style.transform = 'scale(0.95)';
          });
          
          button.addEventListener('touchend', function(e) {
            setTimeout(() => {
              this.style.transform = '';
            }, 150);
          });
        });
        
        // Add swipe to close functionality
        let startY = 0;
        let currentY = 0;
        let isDragging = false;
        
        popup.addEventListener('touchstart', function(e) {
          startY = e.touches[0].clientY;
          isDragging = true;
        });
        
        popup.addEventListener('touchmove', function(e) {
          if (!isDragging) return;
          currentY = e.touches[0].clientY;
          const diffY = currentY - startY;
          
          if (diffY > 50) { // Swipe down to close
            closeTelegramPopup();
            isDragging = false;
          }
        });
        
        popup.addEventListener('touchend', function(e) {
          isDragging = false;
        });
      }
    }

    function closeTelegramPopup() {
      const popup = document.getElementById('telegramPopup');
      popup.classList.remove('show');
      // Restore body scroll on mobile
      document.body.style.overflow = '';
      // Don't store preference - show on every refresh as requested
    }

    function joinTelegram() {
      // Replace with your actual Telegram channel link
      window.open('https://t.me/HDCRICKETWALLS', '_blank');
      closeTelegramPopup();
    }

    // Create floating particles effect
    function createFloatingParticles() {
      const popup = document.getElementById('telegramPopup');
      for (let i = 0; i < 6; i++) {
        const particle = document.createElement('div');
        particle.style.cssText = `
          position: absolute;
          width: 4px;
          height: 4px;
          background: linear-gradient(45deg, #0088cc, #8a2be2, #ff1493);
          border-radius: 50%;
          pointer-events: none;
          z-index: 10001;
          animation: floatParticle ${2 + Math.random() * 3}s ease-in-out infinite;
          left: ${Math.random() * 100}%;
          top: ${Math.random() * 100}%;
        `;
        popup.appendChild(particle);
        
        // Remove particle after animation
        setTimeout(() => {
          if (particle.parentNode) {
            particle.parentNode.removeChild(particle);
          }
        }, 5000);
      }
    }

    // Add floating particles animation
    const style = document.createElement('style');
    style.textContent = `
      @keyframes floatParticle {
        0%, 100% {
          transform: translateY(0px) scale(1);
          opacity: 0.7;
        }
        50% {
          transform: translateY(-20px) scale(1.2);
          opacity: 1;
        }
      }
    `;
    document.head.appendChild(style);

    // Hide loading overlay
    function hideLoadingOverlay() {
      const loadingOverlay = document.getElementById('loadingOverlay');
      setTimeout(() => {
        loadingOverlay.classList.add('hidden');
      }, 2000);
    }

    document.addEventListener('DOMContentLoaded', async () => {  
      // Show loading overlay initially
      hideLoadingOverlay();
      
      // Always show popup on page refresh as requested
      showTelegramPopup();

      shaka.polyfill.installAll();  

      if (!shaka.Player.isBrowserSupported()) {  
        console.error('Browser not supported');  
        return;  
      }  

      const video = document.querySelector('video');  
      const player = new shaka.Player();  
      await player.attach(video);  

      const container = document.querySelector('.shaka-video-container');  
      const ui = new shaka.ui.Overlay(player, container, video);  

      ui.configure({  
        controlPanelElements: [  
          'play_pause', 'time_and_duration', 'mute', 'volume',  
          'spacer', 'language', 'captions', 'picture_in_picture',  
          'quality', 'fullscreen'  
        ],  
        volumeBarColors: {  
          base: 'rgba(255, 192, 203, 0.3)',  
          level: 'rgb(255, 105, 180)'  
        },  
        seekBarColors: {  
          base: 'rgba(255, 255, 0, 0.3)',  
          buffered: 'rgba(255, 255, 0, 0.6)',  
          played: 'rgb(255, 255, 0)'  
        }  
      });  

      // ✅ Use your DRM Key + MPD URL here  
      let drmConfig = {  
        clearKeys: {  
            "31b13c6f241055aaa965263f3115e684": "61f0cbc9599925a7be93d45e30b8ebe9"    
        }  
      };  

      let cookieHeader = "__hdnea=st=1758392406~exp=1758478806~acl=/*~hmac=48d94f13ec574d6d9798365f006cd430ccd5ca3d776bde0a3335f979bf794bc5";
      let streamUrl = "https://jiotvbpkmob.cdn.jio.com/bpk-tv/Asia_Cup_Hindi_MOB/WDVLive/index.mpd?__hdnea=st=1758392406~exp=1758478806~acl=/*~hmac=48d94f13ec574d6d9798365f006cd430ccd5ca3d776bde0a3335f979bf794bc5";
      player.configure({  
        drm: drmConfig,  
        streaming: {  
          lowLatencyMode: true,  
          bufferingGoal: 15,  
          rebufferingGoal: 2,  
          bufferBehind: 15,  
          retryParameters: {  
            timeout: 10000,  
            maxAttempts: 5,  
            baseDelay: 300,  
            backoffFactor: 1.2  
          },  
          segmentRequestTimeout: 8000,  
          segmentPrefetchLimit: 2,  
          useNativeHlsOnSafari: true  
        },  
        manifest: {  
          retryParameters: {  
            timeout: 8000,  
            maxAttempts: 3  
          }  
        }  
      });  

      player.getNetworkingEngine().registerRequestFilter((type, request) => {  
        request.headers['Referer'] = 'https://www.jiotv.com/';
        request.headers['User-Agent'] = "plaYtv/7.1.5 (Linux;Android 13) ExoPlayerLib/2.11.6";  
        request.headers['Cookie'] = cookieHeader;  

        if (  
          (type === shaka.net.NetworkingEngine.RequestType.MANIFEST ||  
            type === shaka.net.NetworkingEngine.RequestType.SEGMENT) &&  
          request.uris[0] && !request.uris[0].includes('__hdnea=')  
        ) {  
          const separator = request.uris[0].includes('?') ? '&' : '?';  
          request.uris[0] += separator + cookieHeader;  
        }  
      });  

      const enableAutoplay = () => {  
        video.setAttribute('autoplay', '');  
        video.setAttribute('playsinline', '');  
        video.autoplay = true;  
      };  

      const attemptAutoplay = async () => {  
        try {  
          video.muted = false;  
          await video.play();  
          console.log('Unmuted autoplay successful');  
          return true;  
        } catch (error) {  
          console.log('Unmuted autoplay failed:', error.message);  
          try {  
            video.muted = true;  
            await video.play();  
            console.log('Muted autoplay successful');  
            return true;  
          } catch (mutedError) {  
            console.log('Muted autoplay failed:', mutedError.message);  
            return false;  
          }  
        }  
      };  

      player.addEventListener('error', (event) => {  
        console.error('Shaka Player Error:', event.detail);  
      });  

      video.addEventListener('play', () => {  
        if (window.self === window.top && !document.fullscreenElement && window.innerWidth <= 768) {  
          container.requestFullscreen().catch(() => {  
            console.log('Fullscreen request failed');  
          });  
        }  
      }, { once: true });  

      video.addEventListener('loadedmetadata', () => {  
        video.volume = 0.8;  
      });  

      let hasUserInteracted = false;  
      const enableSoundOnInteraction = () => {  
        if (!hasUserInteracted && video.muted) {  
          video.muted = false;  
          hasUserInteracted = true;  
          console.log('Sound enabled after user interaction');  
        }  
      };  
      ['click', 'touchstart', 'keydown'].forEach(event => {  
        document.addEventListener(event, enableSoundOnInteraction, { once: true });  
      });  

      try {  
        enableAutoplay();  
        await player.load(streamUrl);  
        if (video.readyState >= 3) {  
          await attemptAutoplay();  
        } else {  
          video.addEventListener('canplay', attemptAutoplay, { once: true });  
          setTimeout(async () => {  
            if (video.paused) {  
              await attemptAutoplay();  
            }  
          }, 2000);  
        }  
      } catch (error) {  
        console.error('Load error:', error);  
      }  

      document.addEventListener('visibilitychange', () => {  
        if (!document.hidden && video.paused) {  
          attemptAutoplay();  
        }  
      });  
    });  
  </script>
</body>  
</html>
